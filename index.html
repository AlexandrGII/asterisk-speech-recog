<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 25 March 2009), see www.w3.org" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <title>Speech recognition for Asterisk PBX</title>
  <meta name="description" content=
  "Asterisk AGI script for voice recognition using Cloud Speech API by Google." />
  <style type="text/css">
/*<![CDATA[*/
    body {
      margin-top: 1.0em;
      background-color: #f6772f;
      font-family: Helvetica, Arial, FreeSans, san-serif;
      color: #000000;
    }
    #container {
      margin: 0 auto;
      width: 750px;
    }
    h1 { font-size: 3.5em; color: #ffffff; margin-bottom: 3px; }
    h1 .small { font-size: 0.4em; }
    h1 a { text-decoration: none }
    h2 { font-size: 1.5em; color: #ffffff; }
    h3 { text-align: center; color: #ffffff; }
    a { color: #ffffff; }
    .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
    .download { float: right; }
    pre { background: #000; color: #fff; padding: 15px;}
    hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
    .footer { text-align:center; padding-top:30px; font-style: italic; }
  /*]]>*/
  </style>
  <style type="text/css">
/*<![CDATA[*/
  img.c1 {position: absolute; top: 0; right: 0; border: 0;}
  /*]]>*/
  </style>
</head>

<body>
  <a href="https://github.com/zaf/asterisk-speech-recog"><img class="c1" src=
  "https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt=
  "Fork me on GitHub" /></a>

  <div id="container">
    <div class="download">
      <a href="https://github.com/zaf/asterisk-speech-recog/zipball/master"><img border="0" width=
      "90" src="https://github.com/images/modules/download/zip.png" /></a> <a href=
      "https://github.com/zaf/asterisk-speech-recog/tarball/master"><img border="0" width="90" src=
      "https://github.com/images/modules/download/tar.png" /></a>
    </div>

    <h1><a href="https://github.com/zaf/asterisk-speech-recog">Speech recognition for
    Asterisk</a></h1>

    <div class="description">
      Speech recognition script for Asterisk that uses Cloud Speech API by Google.
    </div>

    <p>This AGI script makes use of Google's <a href=https://cloud.google.com/speech/>Cloud Speech API</a> in order to render speech to
    text and return it back to the dialplan as an asterisk channel variable. See <a href=
    "https://raw.github.com/zaf/asterisk-speech-recog/master/README">README</a> for a complete list
    of supported languages.</p>

    <h2>Dependencies</h2>

    <p>Perl: The Perl Programming Language<br />
    perl-libwww: The World-Wide Web library for Perl<br />
	perl-libjson: Module for manipulating JSON-formatted data<br />
	IO-Socket-SSL: Perl module that implements an interface to SSL sockets<br />
    flac: Free Lossless Audio Codec<br /></p>

    <h2>Install</h2>

    <p>To install copy speech-recog.agi to your agi-bin directory.<br />
    Usually this is /var/lib/asterisk/agi-bin/<br />
    To make sure check your /etc/asterisk/asterisk.conf file</p>

    <h2>Usage</h2>

    <p><b>agi(speech-recog.agi,[lang],[timeout],[intkey],[NOBEEP])</b>: Records from the current
    channel until 3 seconds of silence are detected (setting the 'timeout' argument to -1 disables
    the silence detection) or the interrupt key (# by default) is pressed. If NOBEEP is set, no
    beep sound is played back to the user to indicate the start of the recording. The recorded
    sound is send over to Google speech recognition service and the returned text string is
    assigned as the value of the channel variable 'utterance'.<br />
    The scripts sets the following channel variables:<br />
    <b>utterance:</b> The transcripted text string.<br />
    <b>confidence:</b> A value between 0 and 1 indicating the probability of a correct
    recognition.Values bigger than 0.90 usually mean that the resulted text is correct.</p>

    <p>Asterisk dialplan examples:<br />
    In these examples <a href="https://zaf.github.com/asterisk-googletts/">googletts.agi</a> script
    is used for speech synthesis:<br /></p>
    <pre>
;;Simple speech recognition
exten =&gt; 1234,1,Answer()
exten =&gt; 1234,n,agi(speech-recog.agi,en-US)
exten =&gt; 1234,n,Verbose(1,The text you just said is: ${utterance})
exten =&gt; 1234,n,Verbose(1,The probability to be right is: ${confidence})
exten =&gt; 1234,n,Hangup()

</pre>
    <pre>
;;Speech recognition demo:
exten =&gt; 1235,1,Answer()
exten =&gt; 1235,n,agi(googletts.agi,"Say something in English, when done press the pound key.",en)
exten =&gt; 1235,n(record),agi(speech-recog.agi,en-US)
exten =&gt; 1235,n,Verbose(1,Script returned: ${confidence} , ${utterance})

;Check the probability of a successful recognition:
exten =&gt; 1235,n(success),GotoIf($["${confidence}" &gt; "0.8"]?playback:retry)

;Playback the text:
exten =&gt; 1235,n(playback),agi(googletts.agi,"The text you just said was...",en)
exten =&gt; 1235,n,agi(googletts.agi,"${utterance}",en)
exten =&gt; 1235,n,goto(end)

;Retry in case speech recognition wasn't successful:
exten =&gt; 1235,n(retry),agi(googletts.agi,"Can you please repeat more clearly?",en)
exten =&gt; 1235,n,goto(record)

exten =&gt; 1235,n(fail),agi(googletts.agi,"Failed to get speech data.",en)
exten =&gt; 1235,n(end),Hangup()

</pre>
    <pre>
;;Voice dialing example
exten =&gt; 1236,1,Answer()
exten =&gt; 1236,n,agi(googletts.agi,"Please say the number you want to dial.",en)
exten =&gt; 1236,n(record),agi(speech-recog.agi,en-US)
exten =&gt; 1236,n,GotoIf($["${confidence}" &gt; "0.8"]?success:retry)

exten =&gt; 1236,n(success),goto(${utterance},1)

exten =&gt; 1236,n(retry),agi(googletts.agi,"Can you please repeat?",en)
exten =&gt; 1236,n,goto(record)

</pre>

    <h2>License</h2>

    <p>The speech-recog script for asterisk is distributed under the GNU General Public License
    v2.</p>

    <h2>Authors</h2>

    <p><a href="https://github.com/zaf">Lefteris Zafiris</a> (zaf@fastmail.com)<br /></p>

    <h2>Download</h2>

    <p>Development snapshots are available in either <a href=
    "https://github.com/zaf/asterisk-speech-recog/zipball/master">zip</a> or <a href=
    "https://github.com/zaf/asterisk-speech-recog/tarball/master">tar</a> formats.</p>

    <p>You can also clone the project with <a href="https://git-scm.com">Git</a> by running:</p>
<pre>
$ git clone git://github.com/zaf/asterisk-speech-recog
</pre>

    <h2>Links</h2>

    <p><a href="https://zaf.github.com/asterisk-googletts/">GoogleTTS text to speech script for
    asterisk</a><br />
	<a href="https://zaf.github.com/asterisk-googletranslate/">Text translation using Google Translate
    API for Asterisk</a><br />
    <a href="https://zaf.github.com/asterisk-mstts/">Speech synthesis using Microsoft Translator
    API for Asterisk</a><br />
    <a href="https://zaf.github.com/Asterisk-Flite/">Asterisk Flite text to speech module</a><br />
    <a href="https://zaf.github.com/Asterisk-eSpeak/">Asterisk e-Speak text to speech module</a></p>

    <div class="footer">
      get the source code on GitHub : <a href=
      "https://github.com/zaf/asterisk-speech-recog">zaf/asterisk-speech-recog</a>
    </div>
  </div>
</body>
</html>
